---
title: Techno Countdowns
layout: null
---

<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ site.title }}</title>
  <meta name="description" content="{{ site.description }}">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ '/assets/styles.css' | relative_url }}">
</head>

<body>
  <header>
    <div class="title">Techno Deadlines</div>
    <div class="subtitle">Countdowns for presales, ticket tiers, camping & shuttle bookings, refund cutoffs, and more.
    </div>
    <div class="controls">
      <!-- view toggle -->
      <div class="toggle" role="tablist" aria-label="View">
        <button id="view-list" class="active" aria-pressed="true">List</button>
        <button id="view-board" aria-pressed="false">Board</button>
      </div>

      <!-- filters -->
      <input id="q" placeholder="Search festival or city…" />
      <select id="type" aria-label="Deadline type">
        <option value="">All deadline types</option>
        <option>presale_signup</option>
        <option>presale</option>
        <option>general_sale</option>
        <option>tier1_ends</option>
        <option>tier2_ends</option>
        <option>payment_plan</option>
        <option>camping_booking</option>
        <option>shuttle_booking</option>
        <option>refund_transfer</option>
        <option>travel_package</option>
        <option>lineup_drop</option>
        <option>other</option>
      </select>
      <select id="month" aria-label="Festival month">
        <option value="">Any month</option>
      </select>
      <select id="country" aria-label="Country">
        <option value="">Any country</option>
      </select>

      <!-- global ICS for filtered view (kept) -->
      <button id="dlics" class="pill">Download .ics (filtered)</button>
    </div>
  </header>

  <main>
    <!-- LIST view table -->
    <div class="table-wrap" id="list-wrap" style="display:block">
      <table id="fest-table">
        <thead>
          <tr>
            <th>Festival</th>
            <th>Place</th>
            <th>Festival dates</th>
            <th>Next deadline</th>
            <th>When</th>
            <th>Countdown</th>
            <th><!-- per-festival ics --></th>
          </tr>
        </thead>
        <tbody id="list"></tbody>
      </table>
    </div>

    <!-- BOARD view grid -->
    <div id="board-wrap" style="display:none">
      <div id="grid" class="grid"></div>
    </div>
  </main>

  <footer>
    Inspired by <a href="https://aideadlin.es/">ai-deadlines</a>. Data is community-maintained — verify details on
    official festival websites.
  </footer>

  <script>
    const DATA = {{ site.data.festivals | jsonify }};
    const QS = s => document.querySelector(s);
    const acid = getComputedStyle(document.documentElement).getPropertyValue('--acid') || '#39ff14';

    // --- Dates & helpers ---
    function parseAt(s) { return s ? new Date(s.replace(/-/g, '/').replace(' ', 'T') + (s.length <= 10 ? 'T00:00:00' : '')) : null; }

    // NEW: future deadlines list (sorted)
    function futureDeadlines(f) {
      const now = new Date();
      return (f.deadlines || [])
        .map(d => ({ ...d, atDate: parseAt(d.at) }))
        .filter(d => d.atDate && d.atDate > now)
        .sort((a, b) => a.atDate - b.atDate);
    }

    function nextDeadline(f) {
      const fut = futureDeadlines(f);
      return fut[0] || null;
    }

    function allDeadlinesSorted(f) {
      return (f.deadlines || [])
        .map(d => ({ ...d, atDate: parseAt(d.at) }))
        .filter(d => d.atDate)
        .sort((a, b) => a.atDate - b.atDate);
    }

    function daysLeft(t) {
      const ms = t - new Date(); if (ms <= 0) return 'now';
      const d = Math.floor(ms / 86400000), h = Math.floor((ms % 86400000) / 3600000);
      return `${d}d ${h}h`;
    }

    // NEW: display helper for the chips
    function formatDeadline(d, tz) {
      try { return `${d.label} — ${d.atDate.toLocaleString(undefined, tz ? { timeZone: tz } : undefined)}`; }
      catch { return `${d.label} — ${d.atDate.toLocaleString()}`; }
    }

    // --- Filters ---
    (function initFilters() {
      const month = QS('#month'), country = QS('#country');
      const months = new Set(), countries = new Set();
      DATA.forEach(f => {
        if (f.start) { months.add(new Date(f.start.replace(/-/g, '/')).toLocaleString(undefined, { month: 'long' })); }
        const m = /,\s*([A-Z]{2})$/.exec(f.place || ''); if (m) countries.add(m[1]);
      });
      [...months].sort((a, b) => new Date(`${a} 1, 2000`) - new Date(`${b} 1, 2000`))
        .forEach(m => { const o = document.createElement('option'); o.textContent = m; o.value = m; month.appendChild(o); });
      [...countries].sort().forEach(c => { const o = document.createElement('option'); o.textContent = c; o.value = c; country.appendChild(o); });
    })();

    // UPDATED: type filter matches ANY future deadline for a festival
    function filteredItems() {
      const q = (QS('#q').value || '').toLowerCase();
      const typ = QS('#type').value;
      const mon = QS('#month').value;
      const ctry = QS('#country').value;

      return DATA.map(f => {
        const fut = futureDeadlines(f);
        const nd = fut[0] || null;
        return { f, nd, fut };
      })
        .filter(({ f, nd, fut }) => (
          (!q || (f.title || '').toLowerCase().includes(q) || (f.place || '').toLowerCase().includes(q)) &&
          (!typ || fut.some(d => d.type === typ)) &&
          (!mon || (f.start && new Date(f.start.replace(/-/g, '/')).toLocaleString(undefined, { month: 'long' }) === mon)) &&
          (!ctry || ((/,[\s]*([A-Z]{2})$/.exec(f.place || '') || [])[1] === ctry))
        ))
        .sort((a, b) => {
          if (a.nd && b.nd) return a.nd.atDate - b.nd.atDate;
          if (a.nd && !b.nd) return -1; if (!a.nd && b.nd) return 1;
          const as = a.f.start ? new Date(a.f.start.replace(/-/g, '/')) : new Date(8640000000000000);
          const bs = b.f.start ? new Date(b.f.start.replace(/-/g, '/')) : new Date(8640000000000000);
          return as - bs;
        });
    }

    // --- ICS helpers (unchanged) ---
    function icsEscape(s) { return (s || '').toString().replace(/\\/g, '\\\\').replace(/\n/g, '\\n').replace(/,/g, '\\,').replace(/;/g, '\\;'); }
    function dtstamp(d) { const p = n => String(n).padStart(2, '0'); return d.getUTCFullYear() + p(d.getUTCMonth() + 1) + p(d.getUTCDate()) + 'T' + p(d.getUTCHours()) + p(d.getUTCMinutes()) + p(d.getUTCSeconds()) + 'Z'; }
    function eventICS(f, d) {
      const start = d.atDate, end = new Date(start.getTime() + 3600000);
      const uid = `${(f.id || f.title)}-${d.type}-${dtstamp(start)}@technodeadlines`;
      const summary = `${f.title} — ${d.label}`, loc = f.place || '', url = f.link || '';
      const desc = `Type: ${d.type}${url ? "\\n" + url : ""}`;
      return ['BEGIN:VEVENT', `UID:${uid}`, `DTSTAMP:${dtstamp(new Date())}`, `DTSTART:${dtstamp(start)}`, `DTEND:${dtstamp(end)}`, `SUMMARY:${icsEscape(summary)}`, `LOCATION:${icsEscape(loc)}`, `DESCRIPTION:${icsEscape(desc)}`, 'END:VEVENT'].join('\n');
    }
    function buildICS(events) {
      return ['BEGIN:VCALENDAR', 'VERSION:2.0', 'PRODID:-//Techno Deadlines//EN', 'CALSCALE:GREGORIAN', events.join('\n'), 'END:VCALENDAR'].join('\n');
    }
    function downloadBlob(text, filename) {
      const blob = new Blob([text], { type: 'text/calendar;charset=utf-8' });
      const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = filename; document.body.appendChild(a); a.click(); a.remove();
    }
    function downloadICSFiltered() {
      const items = filteredItems();
      const all = [];
      items.forEach(({ f }) => allDeadlinesSorted(f).forEach(d => all.push(eventICS(f, d))));
      downloadBlob(buildICS(all), 'techno-deadlines.ics');
    }
    function downloadFestivalICS(f) {
      const events = allDeadlinesSorted(f).map(d => eventICS(f, d));
      const slug = (f.id || f.title || 'festival').toString().toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-+|-+$/g, '');
      downloadBlob(buildICS(events), `${slug}.ics`);
    }

    // --- Renderers ---
    // LIST view now shows ALL upcoming deadlines in a second row
    function renderList() {
      const tbody = QS('#list'); tbody.innerHTML = '';
      filteredItems().forEach(({ f, nd, fut }) => {
        const tr = document.createElement('tr');

        const tdFest = document.createElement('td'); tdFest.setAttribute('data-label', 'Festival');
        const name = f.link ? `<a class="fest-link" href="${f.link}" target="_blank" rel="noopener">${f.title}</a>` : `<span class="fest-link">${f.title}</span>`;
        tdFest.innerHTML = name; tr.appendChild(tdFest);

        const tdPlace = document.createElement('td'); tdPlace.setAttribute('data-label', 'Place');
        tdPlace.innerHTML = f.place ? `<span>${f.place}</span>` : '<span class="muted">—</span>'; tr.appendChild(tdPlace);

        const tdDates = document.createElement('td'); tdDates.setAttribute('data-label', 'Festival dates');
        tdDates.innerHTML = f.date ? `<span>${f.date}</span>` : '<span class="muted">—</span>'; tr.appendChild(tdDates);

        const tdLabel = document.createElement('td'); tdLabel.setAttribute('data-label', 'Next deadline');
        tdLabel.innerHTML = nd ? `<span class="badge">${nd.label}</span>` : '<span class="muted">—</span>'; tr.appendChild(tdLabel);

        const tdWhen = document.createElement('td'); tdWhen.setAttribute('data-label', 'When');
        tdWhen.textContent = nd ? nd.atDate.toLocaleString() : '—'; tr.appendChild(tdWhen);

        const tdCountdown = document.createElement('td'); tdCountdown.setAttribute('data-label', 'Countdown');
        tdCountdown.innerHTML = nd ? `<span class="count">${daysLeft(nd.atDate)}</span>` : '—'; tr.appendChild(tdCountdown);

        const tdICS = document.createElement('td'); tdICS.setAttribute('data-label', 'Download');
        const btn = document.createElement('button'); btn.className = 'btn'; btn.type = 'button'; btn.textContent = 'Download .ics';
        btn.addEventListener('click', () => downloadFestivalICS(f));
        tdICS.appendChild(btn); tr.appendChild(tdICS);

        tbody.appendChild(tr);

        // NEW: row under each festival with ALL upcoming deadlines
        if (fut.length) {
          const tr2 = document.createElement('tr');
          const tdAll = document.createElement('td');
          tdAll.colSpan = 7; // full width under the header columns
          tdAll.className = 'all-deadlines';
          tdAll.innerHTML = 'All upcoming: ' + fut.map(d => `<span class="chip">${formatDeadline(d, f.timezone)}</span>`).join(' ');
          tr2.appendChild(tdAll);
          tbody.appendChild(tr2);
        }
      });
    }

    // BOARD view shows the same set of upcoming deadlines as chips
    function renderBoard() {
      const grid = QS('#grid'); grid.innerHTML = '';
      filteredItems().forEach(({ f, nd, fut }) => {
        const card = document.createElement('div'); card.className = 'card';

        const top = document.createElement('div'); top.className = 'row';
        const left = document.createElement('div');
        const name = f.link ? `<a class="fest-link" href="${f.link}" target="_blank" rel="noopener">${f.title}</a>` : `<span class="fest-link">${f.title}</span>`;
        left.innerHTML = `${name}<div class="subtitle">${f.place || ''} · ${f.date || ''}</div>`;
        const right = document.createElement('div'); right.className = 'actions';
        const btn = document.createElement('button'); btn.className = 'btn'; btn.type = 'button'; btn.textContent = 'Download .ics';
        btn.addEventListener('click', () => downloadFestivalICS(f));
        right.appendChild(btn);
        top.appendChild(left); top.appendChild(right);
        card.appendChild(top);

        if (nd) {
          const row = document.createElement('div'); row.className = 'row';
          row.innerHTML = `<div style="color:${acid};font-weight:600">${nd.label}</div><div class="count">${daysLeft(nd.atDate)}</div>`;
          card.appendChild(row);
          const sub = document.createElement('div'); sub.className = 'subtitle';
          sub.textContent = `Due: ${nd.atDate.toLocaleString()} (${nd.type})`;
          card.appendChild(sub);
        } else {
          const sub = document.createElement('div'); sub.className = 'subtitle';
          sub.textContent = 'No upcoming deadlines yet'; card.appendChild(sub);
        }

        if (fut.length) {
          const wrap = document.createElement('div'); wrap.className = 'chips';
          wrap.innerHTML = fut.map(d => `<span class="chip">${formatDeadline(d, f.timezone)}</span>`).join(' ');
          card.appendChild(wrap);
        }

        grid.appendChild(card);
      });
    }

    function render() {
      const isList = QS('#view-list').classList.contains('active');
      QS('#list-wrap').style.display = isList ? 'block' : 'none';
      QS('#board-wrap').style.display = isList ? 'none' : 'block';
      (isList ? renderList : renderBoard)();
    }

    // --- Wire up ---
    ['#q', '#type', '#month', '#country'].forEach(s => QS(s).addEventListener('input', render));
    QS('#dlics').addEventListener('click', downloadICSFiltered);

    QS('#view-list').addEventListener('click', () => {
      QS('#view-list').classList.add('active'); QS('#view-list').setAttribute('aria-pressed', 'true');
      QS('#view-board').classList.remove('active'); QS('#view-board').setAttribute('aria-pressed', 'false');
      render();
    });
    QS('#view-board').addEventListener('click', () => {
      QS('#view-board').classList.add('active'); QS('#view-board').setAttribute('aria-pressed', 'true');
      QS('#view-list').classList.remove('active'); QS('#view-list').setAttribute('aria-pressed', 'false');
      render();
    });

    // initial paint
    render();
  </script>
</body>

</html>
